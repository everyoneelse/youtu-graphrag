# æ–¹æ¡ˆBå®ç°æ€»ç»“

## ğŸ¯ ç›®æ ‡è¾¾æˆ

âœ… **å‘é‡èšç±»**ï¼šä½¿ç”¨ç®€åŒ–æè¿°ï¼ˆæ—  chunk_id å’Œ labelï¼‰  
âœ… **LLM prompt**ï¼šä½¿ç”¨å®Œæ•´æè¿°ï¼ˆåŒ…å«æ‰€æœ‰ä¿¡æ¯ï¼‰  
âœ… **ä¸å½±å“å…¶ä»–åŠŸèƒ½**ï¼šåŸæœ‰ `_describe_node` ä¿æŒä¸å˜

## ğŸ“Š æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      èŠ‚ç‚¹æ•°æ®                                 â”‚
â”‚  properties: {name: "å…³é”®è§’åº¦", value: "55Â°", chunk_id: "..."}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â–¼                          â–¼
              _describe_node()          _describe_node_for_clustering()
                          â”‚                          â”‚
                          â–¼                          â–¼
            å…³é”®è§’åº¦: 55Â°                  å…³é”®è§’åº¦: 55Â°
            (chunk id: PHuCr1nf)
            [attribute]
                          â”‚                          â”‚
                          â–¼                          â–¼
                    description            description_for_clustering
                          â”‚                          â”‚
                          â–¼                          â–¼
                  LLM Prompt                 Vector Clustering
                (å®Œæ•´ä¿¡æ¯åˆ¤æ–­)                  (çº¯è¯­ä¹‰èšç±»)
```

## ğŸ”§ å…³é”®ä¿®æ”¹

### 1. æ–°å¢æ–¹æ³•ï¼ˆç¬¬741-768è¡Œï¼‰
```python
def _describe_node_for_clustering(self, node_id: str) -> str:
    """ç”Ÿæˆç”¨äºèšç±»çš„ç®€åŒ–æè¿°ï¼Œæ’é™¤ chunk_id å’Œ label"""
    # åªä¿ç•™ name å’Œå…¶ä»–è¯­ä¹‰å±æ€§
```

### 2. è¾¹å»é‡ä¿®æ”¹ï¼ˆç¬¬1634è¡Œï¼‰
```python
entries.append({
    "description": self._describe_node(tail_id),                    # â†’ LLM
    "description_for_clustering": self._describe_node_for_clustering(tail_id),  # â†’ Vector
    ...
})
```

### 3. å…³é”®è¯å»é‡ä¿®æ”¹ï¼ˆç¬¬1324-1346è¡Œï¼‰
```python
source_entity_name_full = self._describe_node(source_entity_id)           # â†’ LLM
source_entity_name_simple = self._describe_node_for_clustering(source_entity_id)  # â†’ Vector
```

### 4. èšç±»è°ƒç”¨ä¿®æ”¹ï¼ˆç¬¬1654ã€1395è¡Œï¼‰
```python
# ä½¿ç”¨ç®€åŒ–æè¿°è¿›è¡Œå‘é‡èšç±»
candidate_descriptions = [entry["description_for_clustering"] for entry in entries]
initial_clusters = self._cluster_candidate_tails(candidate_descriptions, threshold)
```

### 5. LLM Prompt ä¿æŒä¸å˜ï¼ˆç¬¬925è¡Œï¼‰
```python
# LLM prompt ä½¿ç”¨å®Œæ•´æè¿°
description = entry.get("description") or "[NO DESCRIPTION]"
```

## ğŸ“ˆ æ•ˆæœå¯¹æ¯”

| é˜¶æ®µ | ä¿®æ”¹å‰ | ä¿®æ”¹åï¼ˆæ–¹æ¡ˆBï¼‰ |
|------|--------|----------------|
| **å‘é‡èšç±»** | `å…³é”®è§’åº¦: 55Â° (chunk id: PHuCr1nf) [attribute]` | `å…³é”®è§’åº¦: 55Â°` âœ¨ |
| **LLM Prompt** | `å…³é”®è§’åº¦: 55Â° (chunk id: PHuCr1nf) [attribute]` | `å…³é”®è§’åº¦: 55Â° (chunk id: PHuCr1nf) [attribute]` âœ… |

## âœ¨ ä¼˜åŠ¿

### å‘é‡èšç±»æ›´å‡†ç¡®
- âŒ å»é™¤æŠ€æœ¯å…ƒæ•°æ®å™ªéŸ³ï¼ˆchunk_idã€labelï¼‰
- âœ… ä¸“æ³¨æ ¸å¿ƒè¯­ä¹‰å†…å®¹
- âœ… è·¨ chunk çš„ç›¸åŒæ¦‚å¿µæ›´å®¹æ˜“è¯†åˆ«

### LLM åˆ¤æ–­æ›´ç²¾å‡†
- âœ… ä¿ç•™å®Œæ•´ä¸Šä¸‹æ–‡ä¿¡æ¯
- âœ… å¯åˆ©ç”¨ chunk_id è¿›è¡Œæº¯æº
- âœ… label ä¿¡æ¯å¸®åŠ©ç†è§£èŠ‚ç‚¹ç±»å‹

### ä¸¤é˜¶æ®µååŒ
- ğŸš€ **ç¬¬ä¸€é˜¶æ®µ**ï¼šå‘é‡å¿«é€Ÿç²—ç­›ï¼ˆåŸºäºçº¯è¯­ä¹‰ï¼‰
- ğŸ¯ **ç¬¬äºŒé˜¶æ®µ**ï¼šLLM ç²¾ç»†åˆ¤æ–­ï¼ˆåˆ©ç”¨å®Œæ•´ä¿¡æ¯ï¼‰

## ğŸ§ª æµ‹è¯•éªŒè¯

å·²é€šè¿‡å®Œæ•´æµ‹è¯•ï¼š
- âœ… è¾¹å»é‡ï¼šå‘é‡èšç±»ä½¿ç”¨ç®€åŒ–æè¿°
- âœ… è¾¹å»é‡ï¼šLLM prompt ä½¿ç”¨å®Œæ•´æè¿°
- âœ… å…³é”®è¯å»é‡ï¼šå‘é‡èšç±»ä½¿ç”¨ç®€åŒ–æè¿°
- âœ… å…³é”®è¯å»é‡ï¼šLLM prompt ä½¿ç”¨å®Œæ•´æè¿°

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `models/constructor/kt_gen.py` - æ ¸å¿ƒä¿®æ”¹
- `CLUSTERING_DESCRIPTION_CHANGE.md` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- `SCHEME_B_SUMMARY.md` - æœ¬æ–‡æ¡£ï¼ˆå¿«é€Ÿå‚è€ƒï¼‰
